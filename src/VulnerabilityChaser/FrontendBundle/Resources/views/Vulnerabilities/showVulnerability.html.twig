{% extends 'FrontendBundle:Default:base.html.twig' %}

{% block title %}Vulnerabilities{% endblock %}

{% block mVulnerabilities %}class="current_page_item"{% endblock %}

{% block content %}

<table>
<thead>
	<tr>
		<th>Group</th>
		<th>Asset</th>
		<th>Name</th>
		<th>IP Address</th>
		<th>Severity</th>
		<th>CVSS Base</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td>
        {{ vulnerability.assets.agroups.name }}
        </td>
        <td>
		{{ vulnerability.assets.name }}
        </td>
		<td>
		{{ vulnerability.idvulnerabilities.name }}
        </td>
        <td>
		{{ vulnerability.assets.ip }}
        </td>
        <td>
        {{ vulnerability.severityString }}
        </td>
        <td>
        {{ vulnerability.cvssBase }}
        </td>
	</tr>
</tbody>
<thead>
	<tr>
		<th colspan="6">Description</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td colspan="6">{{ vulnerability.idvulnerabilities.description }}</td>
	</tr>
<thead>
	<tr>
		<th colspan="6">Solution</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td colspan="6">
			{{ vulnerability.idvulnerabilities.solution }}
			<br><br>
			{{ vulnerability.evidence }}
			<br><br>
			{% if vulnerability.idvulnerabilities.cve is not empty %}
				Related CVEs:
				<br>
				{% for cve in vulnerability.idvulnerabilities.cve %}
					{{ cve.cve }}
				{% endfor %}
			{% endif %}
		</td>
	</tr>
</tbody>
<thead>
	<tr>
		<th colspan="6">Status History</th>
	</tr>
	<tr>
		<th>Status</th><th>Start Date</th><th colspan="4">Comments</th>
	</tr>
</thead>
<tbody>

<tr>

<form action="#" method="post" {{ form_enctype(form) }}>

    <td>{{ form_errors(form) }} {{ form_row(form.status) }}</td>
    <td>{{ form_row(form.planned) }}</td>
    <td colspan="4">
    {{ form_row(form.comments) }}
	{{ form_rest(form) }}
    <input type="submit" value="new Status" />
    </td>
</form>

</tr>


{% for status in stats %}
	<tr>
		<td>{{ status.status.status}}</td>
		<td>{{ status.datestart | date("m/d/Y")}}</td>
		<td colspan="4">{{ status.comments}}</td>
	</tr>
{% endfor %}
</tbody>
</table>

{% endblock %}
{% extends 'FrontendBundle:Default:base.html.twig' %}

{% block title %}Vulnerabilities{% endblock %}

{% block mAssetGroups %}class="current_page_item"{% endblock %}

{% block content %}

<table>
<thead>
	<tr>
		<th>Group</th>
		<th>Asset</th>
		<th>IP Address</th>
		<th>OS</th>
		<th>System Type</th>
		<th>Owner</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td>
        {{ asset.agroups.name }}
        </td>
        <td>
		{{ asset.name }}
        </td>
        <td>
		{{ asset.ip }}
        </td>
        <td>
        {{ asset.os }}
        </td>
        <td>
        {{ asset.systemType }}
        </td>
        <td>
        {% if asset.users.name is defined %}
        	{{ asset.users.name }}
        	{{ asset.users.lastname }}
        {% endif %}
        </td>
	</tr>
</tbody>
</table>
<br>
<br>
<table id='vulnerabilities'>
<thead>
	<tr>
	<th>Id</th>
	<th>Name</th>
	<th>Status</th>
	<th>Severity</th>
	<th>CVSS Base</th>
	<th>CVSS</th>
	</tr>
</thead>
<tbody>
	{% for vulnerability in asset.vulnerabilities %}
	<tr>
		<td class="row1">
        <a href="{{ path('vulnerability', { 'id': vulnerability.id }) }}">{{ vulnerability.id }}</a>
        </td>
        <td class="row4">
        <a href="{{ path('vulnerability', { 'id': vulnerability.id }) }}">{{ vulnerability.idvulnerabilities.name }}</a>
        </td>
        <td class="row5">
        {{ vulnerability.status[0].status.status }}
        </td>
        <td class="row6">
        {{ vulnerability.severityString }}
        </td>
        <td class="row7">
        {{ vulnerability.cvssBase }}
        </td>
        <td class="row8">
        {{ vulnerability.cvss }}
        </td>
	</tr>
	{% endfor %}
</tbody>



</table>

<div id="TextAsset">
<br>
<br>
<br>
<h3>How to calculate Envorimental metrics</h3>
Different environments can have an immense bearing on the risk that a vulnerability poses to an organization and its stakeholders. The CVSS environmental metric group captures the characteristics of a vulnerability that are associated with a user's IT environment. Since environmental metrics are optional they each include a metric value that has no effect on the score. This value is used when the user feels the particular metric does not apply and wishes to "skip over" it.
<h4>1. Collateral Damage Potential (CDP)</h4>
This metric measures the potential for loss of life or physical assets through damage or theft of property or equipment.  The metric may also measure economic loss of productivity or revenue. The possible values for this metric are listed in Table 10. Naturally, the greater the damage potential, the higher the vulnerability score.
<br><br>
<b>None (N):</b> There is no potential for loss of life, physical assets, productivity or revenue.<br>
<b>Low (L):</b> A successful exploit of this vulnerability may result in slight physical or property damage. Or, there may be a slight loss of revenue or productivity to the organization.<br>
<b>Low-Medium (LM):</b> A successful exploit of this vulnerability may result in moderate physical or property damage. Or, there may be a moderate loss of revenue or productivity to the organization.<br>
<b>Medium-High (MH):</b> A successful exploit of this vulnerability may result in significant physical or property damage or loss. Or, there may be a significant loss of revenue or productivity.<br>
<b>High (H):</b> A successful exploit of this vulnerability may result in catastrophic physical or property damage and loss. Or, there may be a catastrophic loss of revenue or productivity.<br>
<b>Not Defined (ND):</b> Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.
<br><br>
Clearly, each organization must determine for themselves the precise meaning of "slight, moderate, significant, and catastrophic."
<h4>2. Target Distribution (TD)</h4>
This metric measures the proportion of vulnerable systems. It is meant as an environment-specific indicator in order to approximate the percentage of systems that could be affected by the vulnerability. The possible values for this metric are listed in Table 11. The greater the proportion of vulnerable systems, the higher the score.
<br><br>
<b>None (N):</b> No target systems exist, or targets are so highly specialized that they only exist in a laboratory setting. Effectively 0% of the environment is at risk.<br>
<b>Low (L):</b> Targets exist inside the environment, but on a small scale. Between 1% - 25% of the total environment is at risk.<br>
<b>Medium (M):</b> Targets exist inside the environment, but on a medium scale. Between 26% - 75% of the total environment is at risk.<br>
<b>High (H):</b> Targets exist inside the environment on a considerable scale. Between 76% - 100% of the total environment is considered at risk.<br>
<b>Not Defined (ND)</b> Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.<br>
<h4>3. Security Requirements (CR, IR, AR)</h4>
These metrics enable the analyst to customize the CVSS score depending on the importance of the affected IT asset to a users organization, measured in terms of confidentiality, integrity, and availability, That is, if an IT asset supports a business function for which availability is most important, the analyst can assign a greater value to availability, relative to confidentiality and integrity. Each security requirement has three possible values: low, medium, or high.
<br><br>
The full effect on the environmental score is determined by the corresponding base impact metrics (please note that the base confidentiality, integrity and availability impact metrics, themselves, are not changed). That is, these metrics modify the environmental score by reweighting the (base) confidentiality, integrity, and availability impact metrics. For example, the confidentiality impact (C) metric has increased weight if the confidentiality requirement (CR) is high. Likewise, the confidentiality impact metric has decreased weight if the confidentiality requirement is low. The confidentiality impact metric weighting is neutral if the confidentiality requirement is medium. This same logic is applied to the integrity and availability requirements.
<br><br>
Note that the confidentiality requirement will not affect the environmental score if the (base) confidentiality impact is set to none. Also, increasing the confidentiality requirement from medium to high will not change the environmental score when the (base) impact metrics are set to complete. This is because the impact sub score (part of the base score that calculates impact) is already at a maximum value of 10.
<br><br>
The possible values for the security requirements are listed in Table 12. For brevity, the same table is used for all three metrics. The greater the security requirement, the higher the score (remember that medium is considered the default). These metrics will modify the score as much as plus or minus 2.5.
<br><br>
<b>Low (L):</b> Loss of [confidentiality | integrity | availability] is likely to have only a limited adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).<br>
<b>Medium (M):</b> Loss of [confidentiality | integrity | availability] is likely to have a serious adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).<br>
<b>High (H):</b>Loss of [confidentiality | integrity | availability] is likely to have a catastrophic adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).<br>
<b>Not Defined (ND):</b>Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.<br>
<br>
In many organizations, IT resources are labeled with criticality ratings based on network location, business function, and potential for loss of revenue or life. For example, the U.S. government assigns every unclassified IT asset to a grouping of assets called a System. Every System must be assigned three "potential impact" ratings to show the potential impact on the organization if the System is compromised according to three security objectives: confidentiality, integrity, and availability. Thus, every unclassified IT asset in the U.S. government has a potential impact rating of low, moderate, or high with respect to the security objectives of confidentiality, integrity, and availability. This rating system is described within Federal Information Processing Standards (FIPS) 199. CVSS follows this general model of FIPS 199, but does not require organizations to use any particular system for assigning the low, medium, and high impact ratings.
</div>

{% endblock %}

{% block sidebar %}
<center>
<form action="#" method="post" {{ form_enctype(form) }}>
	<br>
	{{ form_widget(form) }}
    <br>
    <input type="submit" value="update" /><br>
</form>
</center>

{% endblock %}
<?php

namespace VulnerabilityChaser\FrontendBundle\Entity;
use Doctrine\ORM\Mapping as ORM;

/**
 * VulnerabilityChaser\FrontendBundle\Entity\Vulnerabilities
 *
 * @ORM\Table(name="vulnerabilities")
 * @ORM\Entity(repositoryClass="VulnerabilityChaser\FrontendBundle\Entity\VulnerabilitiesRepository")
 */
class Vulnerabilities {
	/**
	 * @var integer $id
	 *
	 * @ORM\Column(name="id", type="integer", nullable=false)
	 * @ORM\Id
	 * @ORM\GeneratedValue(strategy="AUTO")
	 */
	private $id;

	/**
	 * @var integer $assetsId
	 *
	 * @ORM\Column(name="assets_id", type="integer", nullable=false)
	 */
	private $assetsId;

	/**
	 * @var integer $idvulnerabilitiesId
	 *
	 * @ORM\Column(name="idVulnerabilities_id", type="integer", nullable=false)
	 */
	private $idvulnerabilitiesId;

	/**
	 * @var string $evidence
	 *
	 * @ORM\Column(name="evidence", type="text", nullable=false)
	 */
	private $evidence;

	/**
	 * @var string $protocol
	 *
	 * @ORM\Column(name="protocol", type="string", length=255, nullable=true)
	 */
	private $protocol;

	/**
	 * @var Assets
	 *
	 * @ORM\ManyToOne(targetEntity="Assets")
	 * @ORM\JoinColumns({
	 *   @ORM\JoinColumn(name="assets_id", referencedColumnName="id")
	 * })
	 */
	private $assets;

	/**
	 * @var Idvulnerabilities
	 *
	 * @ORM\ManyToOne(targetEntity="Idvulnerabilities")
	 * @ORM\JoinColumns({
	 *   @ORM\JoinColumn(name="idVulnerabilities_id", referencedColumnName="id")
	 * })
	 */
	private $idvulnerabilities;

	/**
	 * @var text $service
	 *
	 * @ORM\Column(name="service", type="text", nullable=false)
	 */
	private $service;

	/**
	 * @ORM\OneToMany(targetEntity="Status", mappedBy="vulnerability")
	 * @ORM\OrderBy({"id" = "DESC"})
	 */
	private $status;

	/**
	 * @var integer $port
	 *
	 * @ORM\Column(name="port", type="integer", nullable=false)
	 */
	private $port;

	/**
	 * @var float $cvssBase
	 *
	 * @ORM\Column(name="cvssBase", type="float", nullable=false)
	 */
	private $cvssBase;
	
	/**
	 * @var float $cvss
	 *
	 * @ORM\Column(type="float", nullable=true)
	 */
	private $cvss;
	
	/**
	 * @var string $cvssBaseVector
	 *
	 * @ORM\Column(type="string", length=40, nullable=true)
	 */
	private $cvssBaseVector;
	
	/**
	 * @var string $cvssTmpVector
	 *
	 * @ORM\Column(type="string", length=40, nullable=true)
	 */
	private $cvssTmpVector;


	/**
	 * @var integer $severity
	 *
	 * @ORM\Column(name="severity", type="integer", nullable=false)
	 */
	private $severity;

	/**
	 * Set service
	 *
	 * @param text $service
	 */
	public function setService($service) {
		$this->service = $service;
	}

	/**
	 * Get service
	 *
	 * @return text
	 */
	public function getService() {
		return $this->service;
	}

	/**
	 * Set id
	 *
	 * @param integer $id
	 */
	public function setId($id) {
		$this->id = $id;
	}

	/**
	 * Get id
	 *
	 * @return integer 
	 */
	public function getId() {
		return $this->id;
	}

	/**
	 * Set assetsId
	 *
	 * @param integer $assetsId
	 */
	public function setAssetsId($assetsId) {
		$this->assetsId = $assetsId;
	}

	/**
	 * Get assetsId
	 *
	 * @return integer 
	 */
	public function getAssetsId() {
		return $this->assetsId;
	}

	/**
	 * Set idvulnerabilitiesId
	 *
	 * @param integer $idvulnerabilitiesId
	 */
	public function setIdvulnerabilitiesId($idvulnerabilitiesId) {
		$this->idvulnerabilitiesId = $idvulnerabilitiesId;
	}

	/**
	 * Get idvulnerabilitiesId
	 *
	 * @return integer 
	 */
	public function getIdvulnerabilitiesId() {
		return $this->idvulnerabilitiesId;
	}

	/**
	 * Set assets
	 *
	 * @param VulnerabilityChaser\FrontendBundle\Entity\Assets $assets
	 */
	public function setAssets(
			\VulnerabilityChaser\FrontendBundle\Entity\Assets $assets) {
		$this->assets = $assets;
	}

	/**
	 * Get assets
	 *
	 * @return VulnerabilityChaser\FrontendBundle\Entity\Assets 
	 */
	public function getAssets() {
		return $this->assets;
	}

	/**
	 * Set idvulnerabilities
	 *
	 * @param VulnerabilityChaser\FrontendBundle\Entity\Idvulnerabilities $idvulnerabilities
	 */
	public function setIdvulnerabilities(
			\VulnerabilityChaser\FrontendBundle\Entity\Idvulnerabilities $idvulnerabilities) {
		$this->idvulnerabilities = $idvulnerabilities;
	}

	/**
	 * Get idvulnerabilities
	 *
	 * @return pfmsc\FrontendBundle\Entity\Idvulnerabilities 
	 */
	public function getIdvulnerabilities() {
		return $this->idvulnerabilities;
	}

	/**
	 * Set evidence
	 *
	 * @param text $evidence
	 */
	public function setEvidence($evidence) {
		$this->evidence = $evidence;
	}

	/**
	 * Get evidence
	 *
	 * @return text 
	 */
	public function getEvidence() {
		return $this->evidence;
	}

	/**
	 * Set protocol
	 *
	 * @param string $ip
	 */
	public function setProtocol($protocol) {
		$this->protocol = $protocol;
	}

	/**
	 * Get protocol
	 *
	 * @return string
	 */
	public function getProtocol() {
		return $this->protocol;
	}

	/**
	 * Set port
	 *
	 * @param integer $port
	 */
	public function setPort($port) {
		$this->port = $port;
	}

	/**
	 * Get port
	 *
	 * @return integer
	 */
	public function getPort() {
		return $this->port;
	}

	public function __construct() {
		$this->status = new \Doctrine\Common\Collections\ArrayCollection();
	}

	/**
	 * Add status
	 *
	 * @param VulnerabilityChaser\FrontendBundle\Entity\Status $status
	 */
	public function addStatus(
			\VulnerabilityChaser\FrontendBundle\Entity\Status $status) {
		$this->status[] = $status;
	}

	/**
	 * Get status
	 *
	 * @return Doctrine\Common\Collections\Collection 
	 */
	public function getStatus() {
		return $this->status;
	}

	/**
	 * Set severity
	 *
	 * @param integer $severity
	 */
	public function setSeverity($severity) {
		$this->severity = $severity;
	}

	/**
	 * Get severity
	 *
	 * @return integer
	 */
	public function getSeverity() {
		return $this->severity;
	}

	public function getSeverityString() {
		switch ($this->severity) {
		case 0:
			return "info";
		case 1:
			return "low";
		case 2:
			return "medium";
		case 3:
			return "high";
		case 4:
			return "critical";
		}
	}

	/**
	 * Set cvssBase
	 *
	 * @param float $cvssBase
	 */
	public function setCvssBase($cvssBase) {
		$this->cvssBase = $cvssBase;
	}

	/**
	 * Get cvssBase
	 *
	 * @return float 
	 */
	public function getCvssBase() {
		return $this->cvssBase;
	}

    /**
     * Set cvssBaseVector
     *
     * @param string $cvssBaseVector
     */
    public function setCvssBaseVector($cvssBaseVector)
    {
        $this->cvssBaseVector = $cvssBaseVector;
    }

    /**
     * Get cvssBaseVector
     *
     * @return string 
     */
    public function getCvssBaseVector()
    {
        return $this->cvssBaseVector;
    }

    /**
     * Set cvssTmpVector
     *
     * @param string $cvssTmpVector
     */
    public function setCvssTmpVector($cvssTmpVector)
    {
        $this->cvssTmpVector = $cvssTmpVector;
    }

    /**
     * Get cvssTmpVector
     *
     * @return string 
     */
    public function getCvssTmpVector()
    {
        return $this->cvssTmpVector;
    }

    /**
     * Set cvss
     *
     * @param float $cvss
     */
    public function setCvss($cvss)
    {
        $this->cvss = $cvss;
    }

    /**
     * Get cvss
     *
     * @return float 
     */
    public function getCvss()
    {
        return $this->cvss;
    }
}
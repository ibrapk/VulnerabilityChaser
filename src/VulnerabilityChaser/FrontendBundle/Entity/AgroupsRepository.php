<?php

namespace VulnerabilityChaser\FrontendBundle\Repository;;

use Doctrine\ORM\EntityRepository;

class AgroupsRepository extends EntityRepository {


	/**
	 * Devuelve un array de dos dimensiones. [grupo][vulnerabilidades del grupo]
	 */
	public function getVulnerabilitiesGroup()
	{
		$em = $this->getEntityManager();
			
		$query = $em->createQuery('SELECT vag, v  FROM FrontendBundle:Vulnerabilities v 
				JOIN v.assets va JOIN va.agroups vag');
		
		try {
			$vPerGroup = $query->getResult();
		} catch (\Doctrine\ORM\NoResultException $e) {
			return null;
		}
		return $vPerGroup;
	}
}

<?php

namespace VulnerabilityChaser\FrontendBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;

use VulnerabilityChaser\FrontendBundle\Entity\Cve;
use VulnerabilityChaser\FrontendBundle\Entity\Assets;
use VulnerabilityChaser\FrontendBundle\Entity\Idvulnerabilities;
use VulnerabilityChaser\FrontendBundle\Entity\Vulnerabilities;

class VulnerabilitiesController extends Controller
{
    
    public function showAction()
    {
        $em = $this->getDoctrine()->getEntityManager();
		$vulnerabilities = $em->getRepository('FrontendBundle:Vulnerabilities')->findAll();

		return $this->render('FrontendBundle:Vulnerabilities:showVulnerabilities.html.twig', array('vulnerabilities' => $vulnerabilities));
    }
    
    public function showVulnerabilityAction($id)
    {
    	$em = $this->getDoctrine()->getEntityManager();
    	$vulnerability = $em->getRepository('FrontendBundle:Vulnerabilities')->findOneById($id);
    
    	return $this->render('FrontendBundle:Vulnerabilities:showVulnerability.html.twig', array('vulnerability' => $vulnerability));
    }
    
    public function showAssetAction($id)
    {
    	$em = $this->getDoctrine()->getEntityManager();
    	$asset = $em->getRepository('FrontendBundle:Assets')->findOneById($id);
    
    	return $this->render('FrontendBundle:Vulnerabilities:showAsset.html.twig', array('asset' => $asset));
    }

}
